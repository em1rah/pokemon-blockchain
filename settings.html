<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Settings</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{min-height:100vh;color:white;background:#0b1021}
    header{background:rgba(0,0,0,.5);backdrop-filter:blur(8px);padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,.1);} 
    header h1{font-family:'Press Start 2P',cursive;color:#ffcb05;font-size:1.1rem}
    nav a{margin-left:1rem;color:#ffcb05;text-decoration:none;font-weight:600;font-family:'Inter',system-ui}
    nav a:hover{color:#fff}
    .coins{display:inline-block;background:#ffeb3b;color:#1a2a6c;padding:6px 12px;border-radius:12px;font-weight:700;margin-left:10px;font-size:0.9rem;}
    .wallet{margin-left:12px;font-size:.9rem;color:#ddd}
    .logout-btn{margin-left:12px;background:#f44336;color:#fff;border:none;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}

    .container{padding:1.5rem;font-family:'Inter',system-ui}
    .title{color:#ffcb05;font-size:1.6rem;margin-bottom:.75rem}
    .field{margin:12px 0}
    .theme-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-top:8px}
    .theme-card{position:relative;border:2px solid rgba(255,255,255,.2);border-radius:14px;overflow:hidden;cursor:pointer;transition:.2s;background:#101425}
    .theme-card:hover{transform:translateY(-2px);border-color:#ffcb05}
    .theme-card input{position:absolute;inset:0;opacity:0;cursor:pointer}
    .theme-thumb{height:84px;background-size:cover;background-position:center}
    .theme-meta{padding:10px;display:flex;align-items:center;justify-content:space-between}
    .theme-name{font-weight:700;color:#ffcb05}
    .theme-badge{width:10px;height:10px;border:2px solid #ffcb05;border-radius:50%;}
    .theme-card.active{border-color:#ffcb05;box-shadow:0 0 0 3px rgba(255,203,5,.15) inset}
    label{display:block;margin-bottom:6px;color:#ffcb05}
    input,select{padding:10px 12px;border-radius:10px;border:1px solid rgba(255,203,5,.4);background:rgba(255,255,255,.1);color:#fff;width:100%}
    .save{margin-top:12px;padding:10px 16px;background:#4caf50;border:none;border-radius:10px;color:#fff;font-weight:700;cursor:pointer}
  </style>
</head>
<body>
  <header>
    <div><h1>Settings</h1></div>
    <nav>
      <a href="home.html">Home</a>
      <a href="arena.html">Arena</a>
      <a href="shop.html">Shop</a>
      <a href="history.html">History</a>
      <span class="coins" id="coinDisplay">0 Coins</span>
      <span class="wallet" id="walletDisplay"></span>
      <button class="logout-btn" id="logoutBtn">Logout</button>
    </nav>
  </header>

  <div class="container">
    <div class="title">Profile</div>
    <div class="field">
      <label for="displayName">Display Name</label>
      <input id="displayName" type="text" placeholder="Enter display name"/>
    </div>

    <div class="title" style="margin-top:18px;">Arena Theme</div>
    <div class="field">
      <label>Choose a background</label>
      <div class="theme-grid" id="themeGrid">
        <div class="theme-card" data-theme="kanto">
          <div class="theme-thumb" style="background-image:url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/kanto-bg.jpg')"></div>
          <div class="theme-meta"><span class="theme-name">Kanto</span><span class="theme-badge"></span></div>
          <input type="radio" name="arenaTheme" value="kanto"/>
        </div>
        <div class="theme-card" data-theme="johto">
          <div class="theme-thumb" style="background-image:url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/johto-bg.jpg')"></div>
          <div class="theme-meta"><span class="theme-name">Johto</span><span class="theme-badge"></span></div>
          <input type="radio" name="arenaTheme" value="johto"/>
        </div>
        <div class="theme-card" data-theme="gym">
          <div class="theme-thumb" style="background-image:url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/gym-bg.jpg')"></div>
          <div class="theme-meta"><span class="theme-name">Gym</span><span class="theme-badge"></span></div>
          <input type="radio" name="arenaTheme" value="gym"/>
        </div>
        <div class="theme-card" data-theme="champion">
          <div class="theme-thumb" style="background-image:url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/champion-bg.jpg')"></div>
          <div class="theme-meta"><span class="theme-name">Champion</span><span class="theme-badge"></span></div>
          <input type="radio" name="arenaTheme" value="champion"/>
        </div>
      </div>
    </div>

    <button class="save" id="saveBtn">Save Settings</button>
  </div>

  <script>
    const session = JSON.parse(localStorage.getItem('trainerSession'));
    if (!session) location.href = 'index.html';
    const USER_ID = session.type === 'metamask' ? session.address.toLowerCase() : session.address.toLowerCase();
    const ns = (k) => `${USER_ID}:${k}`;
    const COIN_KEY = ns('coins');
    const SETTINGS_KEY = ns('settings');

    const walletDisplay = document.getElementById('walletDisplay');
    if (session.type==='metamask') walletDisplay.textContent = session.address.slice(0,6)+"..."+session.address.slice(-4);
    document.getElementById('logoutBtn').onclick = () => { localStorage.removeItem('trainerSession'); location.href = 'index.html'; };

    function getCoins(){ return parseInt(localStorage.getItem(COIN_KEY) || '0'); }
    function setCoins(v){ localStorage.setItem(COIN_KEY, String(v)); document.getElementById('coinDisplay').textContent = v + ' Coins'; }
    if (localStorage.getItem(COIN_KEY) === null) setCoins(500); else setCoins(getCoins());

    function applyTheme(theme){
      document.body.classList.remove('theme-kanto','theme-johto','theme-gym','theme-champion');
      document.body.classList.add(`theme-${theme}`);
    }

    function load(){
      const s = JSON.parse(localStorage.getItem(SETTINGS_KEY) || '{}');
      const theme = s.theme || 'kanto';
      document.querySelectorAll('.theme-card').forEach(c=>c.classList.toggle('active', c.dataset.theme===theme));
      const sel = document.querySelector(`.theme-card[data-theme="${theme}"] input`);
      if (sel) sel.checked = true;
      document.getElementById('displayName').value = s.displayName || '';
      applyTheme(theme);
    }
    document.getElementById('saveBtn').onclick = () => {
      const picked = document.querySelector('input[name="arenaTheme"]:checked');
      const theme = picked ? picked.value : 'kanto';
      const name = document.getElementById('displayName').value.trim();
      const s = { theme, displayName: name };
      localStorage.setItem(SETTINGS_KEY, JSON.stringify(s));
      applyTheme(theme);
      alert('Saved');
    };

    const style = document.createElement('style');
    style.textContent = `.theme-kanto{background:#0b1021 url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/kanto-bg.jpg') center/cover fixed} .theme-johto{background:#0b1021 url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/johto-bg.jpg') center/cover fixed} .theme-gym{background:#0b1021 url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/gym-bg.jpg') center/cover fixed} .theme-champion{background:#0b1021 url('https://raw.githubusercontent.com/iamspruce/hosted-assets/main/pokemon/champion-bg.jpg') center/cover fixed}`;
    document.head.appendChild(style);

    document.getElementById('themeGrid').addEventListener('click', (e)=>{
      const card = e.target.closest('.theme-card');
      if (!card) return;
      document.querySelectorAll('.theme-card').forEach(c=>c.classList.remove('active'));
      card.classList.add('active');
      const theme = card.dataset.theme;
      const input = card.querySelector('input'); if (input) input.checked = true;
      applyTheme(theme);
    });

    load();
  </script>
</body>
</html>

